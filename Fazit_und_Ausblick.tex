% Die Arbeit besteht aus Kapiteln (chapter)
\chapter{Zusammenfassung, Ausblick und Diskussion}

\section{Zusammenfassung und Ausblick}
%Die für diese Arbeit gesetzten Ziele konnten zum Großteil erreicht werden und es konnten einige überraschend gute Ergebnisse erzielt werden. 

%%%%%%%%%% Feedback %%%%%%%%%%%%%%%%
%Bei der Diskussion: Es ist in der aktuellen Form eher eine Zusammenfassung mit Ausblick. Eine Diskussion beschreibt die Möglichkeiten und Grenzen, die im Laufe der Arbeit sich ergaben. Also: Was kann man mit flex in Echtzeit modellieren, was geht nicht, wie sieht es mit der Genauigkeit aus und wo sind weitere Einschränkungen. Das könnte eine Seite sein, die das nochmals hervorhebt. 

\subsubsection{FleX und Unreal Engine 4}
% FleX, UE4 Performance und Simulationsverhalten:
Das Kombinieren von NVIDIA FleX mit einer Game Engine erwies sich als überaus nützlich, um ohne großen Aufwand effiziente und vielfältige Anwendungen für Serious Games zu entwickeln. 
%Ohne die vielen nützlichen Funktionen der Unreal Engine 4 hätten niemals so viele Ergebnisse in solch kurzer Zeit erzielt werden können. 
%Es konnten die wichtigsten Faktoren identifiziert werden, die den größten Einfluss auf die Simulationsperformance von FleX haben (Kapitel \ref{subsec_perf_zusa}). 
Mithilfe des angeeigneten theoretischen Wissens über die verwendete Software und über PBD, konnte stets gut nachvollzogen werden, wieso sich die Simulationen in bestimmten Situationen unterschiedlich verhält. 
So konnten die wichtigsten Punkte herausgearbeitet werden, auf die zu achten ist, um das bestmögliche aus PBD-basierten Simulationen herauszuholen (siehe Kapitel \ref{subsec_perf_zusa}). 
%Die wohl größte Schwäche von NVIDIA FleX ist dabei die Simulation von großen Rigid Bodies, die aus vielen Partikeln (über 4000) bestehen. Hier kommt die Hardware schnell an ihre Grenzen und die Echtzeitfähigkeit kann nicht mehr garantiert werden.

%Für zukünftige Projekte könnte noch getestet werden, ob sich FleX-Simulationen auf Standalone VR Anlagen portieren und effizient ausführen lassen. Es wäre interessant zu klären, ob moderne Hardware, wie die Oculus Quest 2 stark genug sind um FleX Simulationen auszuführen.

%Automatisierung
Ein weiteres Potenzial für zukünftige Arbeiten könnten die Automatisierungswerkzeuge der Unreal Engine bieten. Mithilfe von Python, Blueprint Scripting und C++ kann der Unreal Editor automatisiert werden. So könnten beispielsweise unterschiedliche FleX-Partikelmodelle automatisiert, generiert und simuliert werden, um in kurzer Zeit eine große Datenmenge zu generieren, aus der weitere Erkenntnisse gewonnen werden können.

\subsubsection{Partikelmanipulation}
% Partikelmainpulation auf gpu:
Die PBD-basierte FleX-Simulation war einfach in der Handhabung und konnte schnell erweitert werden, beispielsweise durch Manipulation einzelner Partikel (Kapitel \ref{subsec_forces}). Allerdings wird die Manipulation der Partikel derzeit noch von der CPU berechnet. Zukünftig wäre es besser, die Partikelmanipulationen auf die Grafikkarte zu bringen, gerade wenn größere Partikelmengen verarbeitet werden sollen. 

\subsubsection{Softwareframework für Serious Games im medizinischen Bereich}
%Framework, 
Auf Grundlage der verwendeten Unreal Integration konnte ein umfangreiches Framework erstellt  werden, das gut für die schnelle Entwicklung von Serious Games im medizinischen Bereich geeignet ist (Kapitel \ref{sec_functional}). 
%Das Framework ist ein nützliches Werkzeug für weitere wissenschaftliche Arbeiten und könnte zukünftig dabei helfen, weitere wissenschaftliche Problemstellungen zu lösen. %%%%%%%%%%%%%%%%%%%%%%%%%%%% doofer doppelsatz!!!!!!!!!!!!!
Zwar ist die Installation der Software noch umständlich  und die Portabilität eingeschränkt, aber dennoch kann und wird sie bereits jetzt für weitere wissenschaftliche Projekte vom IWR (Interdisziplinäres Zentrum für wissens. Rechnen) der Universität Heidelberg eingesetzt. 

%Attachment ausblick:
%Wegen Zeitmangels konnten nicht alle gewünschten Funktionalitäten implementiert werden. 
Allerdings ist das Framework noch ausbaufähig. In Kapitel \ref{subsec_attach} wurde zum Beispiel erwähnt, dass sich an FleX-Objekte befestigte Szenen nicht mit dem FleX-Objekt mitdrehen. Dies ist eine interessante Problemstellung für weiterführende wissenschaftliche Arbeiten.

\subsubsection{Demoanwendung und haptisches Feedback}
%Demoanwendung und haptisches Feedback:
Im Rahmen dieser Arbeit entstand eine umfangreiche Demoanwendung, in der die Möglichkeiten von NVIDIA FleX und Game Engines in virtueller Realität erkundet werden können (siehe Abbildung \ref{Demo}). 

\bild{Demo}{13cm}{\href{https://drive.google.com/file/d/1rk51AqzD1PNhjfIWnJPo6_Y4d7exYnvB/view?usp=sharing}{Interaktive Demoanwendung}. Oben links und rechts: Mithilfe einer Pinzette können Fremdkörper aus Gewebe entfernt und Haut zerrissen werden. Unten links und rechts: Trifft die Nadel eine bestimmte Stelle im Gewebe, wird eine interaktive Fluidsimulation gestartet, um eine Blutung darzustellen. Je nach Blutmenge werden 7 bis 20 Tausend Partikel simuliert und die Demo läuft mit 80 bis 120 FPS.}

%Im Rahmen dieser Arbeit konnte die Demoanwendung allerdings nicht im großen Umfang von medizinischen Fachpersonen evaluiert werden, weswegen der Realitätsgrad der Demoanwendung noch nicht bewertet werden konnte. 
Eine ausführliche Evaluierung der Demoanwendung von medizinischem Fachpersonal hätte den Rahmen der Arbeit gesprengt. Daher kann die Praxistauglichkeit der Demoanwendung noch nicht professionell bewertet werden.
Allerdings ist es unbestreitbar, dass das Fehlen des haptischen Feedbacks einen negativen Einfluss auf den Realitätsgrad der Demoanwendung hat.
%Allerdings ist das fehlen einer haptischen Rückmeldung nicht vollständig kompensierbar.
%Dadurch können die motorischen Fähigkeiten nicht effizient trainiert werden. 
%Nur Abläufe und das visuelle Gedächtnis können trainiert werden. 

Dennoch konnte eine funktionierende Lösung für das Fehlen von haptischer Hardware gefunden und prototypisch implementiert werden (Kapitel \ref{subsec_no_haptic}). %Mithilfe von simulierten Kräften kann der Nutzer mit der virtuellen Umgebung interagieren und Werkzeuge benutzen. 
Trotz des Abstriches im Realismus bleibt der Vorteil, dass solche Simulatoren von jeder Person, die eine handelsübliche VR-Anlage besitzt, verwendet werden kann. Dadurch wird die Trainingsmöglichkeit zugänglicher und es können Kosten gespart werden, weil keine haptische Hardware angeschafft werden muss.
%%%%%%%%%%%%%%%% Technische voraussetzung nicht so hoch...


\subsubsection{Nadel-Gewebe Interaktion}
%Nadel-Gewebe und nadel manuel befestigen:
Die Nadel-Gewebe-Interaktion konnte in Kapitel \ref{sec_needle} überraschend gut umgesetzt werden, vor allem weil die simulierten Reibungs- und Klemmkräfte auf die Nadel besonders realistisch erschienen. Auch hier fehlt noch eine Evaluation von medizinischem Fachpersonal.

Aus dem Gewebe herausfallende Nadeln könnten zukünftig mithilfe von manuellen Partikelbefestigungen (Nadel an Gewebe) vermieden werden.

Eine weiter Problemstellung, die noch gelöst werden sollte, ist das Abrutschen der Nadel beim Stechen ins Gewebe. Die Nadel macht keinen spitzen Eindruck, weil sich ihre Spitze nicht mit der Gewebeoberfläche verhakt. Hierfür könnte eine manuelle Lösung implementiert werden, die bewirkt, dass die Spitze der Nadel stärker an der Gewebeoberflächen haftet.

Außerdem könnte die maximale radiale Nadelkraft eingeschränkt werden, solange sich die Nadel im Gewebe befindet, um seitliche Nadelbewegungen im Gewebe stärker einzuschränken.

\clearpage
\section{Diskussion}

% Vielseitigkeit
Insgesamt lässt sich sagen, dass PBD-basierte Physik Engines in Verbindung mit Game Engines gut für  medizinische Echtzeitsimulationen geeignet sind. 
%Auch wenn die heutige Software noch recht spärlich ausgestattet ist, weswegen in dieser Arbeit einige Grundfunktionalitäten selbst implementiert werden mussten. 
NVIDIA FleX profitiert vor allem von einer großen Vielseitigkeit: Festkörper, Gewebe, Häute und Flüssigkeiten können in den meisten Fällen ausreichend performant und akkurat simuliert werden, um optisch realistisch wirkende Bilder zu erhalten.

%FleX Genauigkeit
In dieser Arbeit kann keine genauere Aussage über die Simulationsgenauigkeit von FleX getroffen werden, weil Zeit und Mittel fehlten, um entsprechende Messversuche durchzuführen. Allerdings setzen sich andere Werke wie \cite{BreastBiopsy} und \cite{PBDKidney} sehr detailliert mit dieser Thematik auseinander. In diesen Arbeiten konnten ausreichend akkurate Gewebesimulationen mit FleX aufgesetzt werden. 
%Deswegen wurden in dieser Arbeit auch die selben Simulationseinstellungen verwendet, um Aussagen über die Performance zu treffen und um Anwendungen zu implementieren.

%Flex performance:
Die Performance von NVIDIA FleX überzeugt in den meisten Fällen, auch wenn viele Partikel (ca. 60.000) simuliert werden und anspruchsvolle Simulationsparameter eingesetzt werden. Alle Anwendungen laufen zuverlässig mit 60 bis 120 FPS, solange die Regeln aus Kapitel \ref{subsec_perf_zusa} eingehalten werden. Die wichtigste Regel ist hierbei, die Partikelanzahl pro Cluster klein zu halten. Dies ist keine schlimme Einschränkung, weil viele kleine Cluster keine Nachteile mit sich bringen. Im Gegenteil: In \cite{BreastBiopsy} und \cite{PBDKidney} werden akkurate Gewebesimulationen mit vielen kleinen Clustern umgesetzt.

%große Rigids in FleX
Die wohl größte Schwäche von NVIDIA FleX ist die Simulation von großen Rigid Bodies, die aus zu vielen Partikeln (hier: über 4000) bestehen. Hier kommt die Hardware (hier: GTX 1070) schnell an ihre Grenzen und die Echtzeitfähigkeit kann nicht mehr gewährleistet werden. 
Deswegen kann es Sinn machen, Rigid Bodies mithilfe einer dafür spezialisierten Physik Engine (beispielsweise NVIDIA PhysX) zu simulieren, während Soft Bodies, Häute, Fäden und Flüssigkeiten von NVIDIA FleX simuliert werden. Das Kombinieren von zwei Physik Engines kann allerdings aufwendig  und kompliziert sein (siehe Kapitel \ref{subsec_physXFleX}).
Dieser Extraaufwand lohnt sich nur, wenn so große Rigid Bodies simuliert werden müssen, dass diese nicht mehr von wenigen Partikeln (weniger als 4000 Partikel) repräsentiert werden können. 
In dieser Arbeit war der Einsatz einer separaten Rigid Body Simulation nicht nötig. Nadeln, Pinzetten und Skalpelle konnten jeweils mit weniger als 1000 Partikeln modelliert werden. 

In Anwendungsfällen wie aus \cite{VRSim20} und \cite{VRmagic} müssen außerdem überhaupt keine Rigid Bodies simuliert werden. Zwar sind hier die virtuellen Werkzeuge Festkörper, allerdings müssen diese keine Physik simulieren, weil sich diese immer in der Hand des Anwenders befinden, wo haptisches Feedback erzeugt wird. Dadurch können die Werkzeuge von Polygonmodellen repräsentiert werden und FleX muss nur die Partikel-Polygonmodell-Kollisionen berechnen, was sehr effizient funktioniert. Weil solche Anwendungsfälle häufig vorkommen, ist davon auszugehen, dass die Fähigkeiten von NVIDIA FleX für die meisten Anwendungen ausreichen.



%Ausblick:

%-> Automatisierung des Unreal Editors

%-> Effiziente Wasser bzw Blut shader für Fluid Partikel werden benötigt

%-> haptische Hardware

%-> Partikelmanipulation läuft noch auf CPU!

%-> Nadel manuel an Gewebe befestigen

%... weil FleX inzwischen auch mit DX funktioniert, könnten Simulatoren auch als stand alone variante portiert werden. Dann wird NUR  noch Oculus Quest 2 und kein pc mehr benötigt... allerdings bräuchte man dann ue4.22 mindestens...

%-> attachment rotation

\chapter*{Danksagung}
Zuerst möchte ich mich herzlich bei allen Dozenten der Universität Heidelberg, an deren Vorlesungen ich teilnehmen durfte, bedanken. Alle Dozenten waren mir eine große Hilfe und lehrten stets mit Leidenschaft und Hingabe, wodurch nicht nur mein Verständnis, sondern auch meine Motivation wuchs.

Ein ganz besonderes Dankeschön geht an meinen Betreuer Herrn Prof. Dr. Hesser, der mich nicht nur hervorragend bei dieser Arbeit unterstützte, sondern mir auch viel über Computergrafik, Echtzeitsimulationen und Game-Development beibrachte, was sich zu einer meiner größten Leidenschaften entwickelt hat.

Danke für die vielen inspirierenden Gespräche und Hilfestellungen von Josia Muench, Sara Nonji Azad, Marvin Kinz und Julian Gröger. Abschließend danke ich meinen Freunden und Verwandten, die mich während meines Studiums immer bedingungslos unterstützt haben.
